<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YUSUF AKDENIZ | CALENDAR PRO v17</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');
        :root { --sidebar-w: 280px; --primary: #4318ff; --dark: #111c44; --light-bg: #f4f7fe; }
        * { margin:0; padding:0; box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; }
        body { background: var(--light-bg); color: #1b2559; }

        /* SIDEBAR */
        .sidebar { width: var(--sidebar-w); height: 100vh; background: #fff; position: fixed; left: 0; top: 0; z-index: 1000; border-right: 1px solid #e9edf7; }
        .nav-link { margin: 4px 20px; padding: 16px 20px; display: flex; align-items: center; gap: 15px; color: #a3aed0; font-weight: 700; border-radius: 15px; cursor: pointer; transition: 0.2s; }
        .nav-link:hover, .nav-active { background: var(--light-bg); color: var(--primary); }

        .main-content { margin-left: var(--sidebar-w); padding: 40px; }
        .glass-card { background: #fff; border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(112, 144, 176, 0.1); }

        /* üóìÔ∏è RANDEVU S√úTUNLARI (HAFTALIK TABLO) */
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 15px; min-width: 1000px; }
        .day-column { background: #f8f9ff; border-radius: 20px; padding: 15px; min-height: 600px; border: 1px solid #eef0f7; }
        .day-header { text-align: center; padding-bottom: 15px; border-bottom: 2px solid #fff; margin-bottom: 15px; }
        .day-header h5 { font-weight: 800; text-transform: uppercase; font-size: 13px; color: var(--primary); }
        
        .appointment-item { background: white; border-radius: 12px; padding: 12px; margin-bottom: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.02); border-left: 4px solid #4318ff; position: relative; }
        .appointment-item .time { font-size: 11px; font-weight: 800; color: #a3aed0; }
        .appointment-item .name { font-size: 13px; font-weight: 700; color: #1b2559; display: block; margin-top: 2px; }
        .del-btn { position: absolute; top: 5px; right: 5px; opacity: 0; transition: 0.2s; color: #ff5b5b; cursor: pointer; }
        .appointment-item:hover .del-btn { opacity: 1; }

        @media (max-width: 1024px) {
            .sidebar { width: 85px; }
            .sidebar span, .sidebar h1, .sidebar p { display: none; }
            .main-content { margin-left: 85px; padding: 15px; }
            .calendar-container { overflow-x: auto; }
        }

        /* MODALS & INPUTS */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.4); backdrop-filter: blur(8px); z-index: 2000; align-items: center; justify-content: center; }
        .modal-content { background: #fff; width: 90%; max-width: 500px; padding: 35px; border-radius: 30px; }
        input, select, textarea { width: 100%; background: #f4f7fe; border: 2px solid #e9edf7; padding: 15px; border-radius: 16px; margin-bottom: 15px; font-weight: 600; outline: none; }
        .btn-action { background: var(--primary); color: #fff; padding: 15px 25px; border-radius: 16px; font-weight: 800; cursor: pointer; width: 100%; transition: 0.3s; }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="p-10 text-center"><h1 class="text-2xl font-black italic">PALACE</h1><p class="text-[10px] font-bold text-slate-300 tracking-[3px]">MANAGEMENT</p></div>
        <div class="nav-container">
            <div onclick="tab('dash')" id="n-dash" class="nav-link nav-active"><i class="fa-solid fa-chart-pie"></i> <span>Dashboard</span></div>
            <div onclick="tab('must')" id="n-must" class="nav-link"><i class="fa-solid fa-user-group"></i> <span>M√º≈üteriler</span></div>
            <div onclick="tab('rand')" id="n-rand" class="nav-link"><i class="fa-solid fa-calendar-week"></i> <span>Randevu Sistemi</span></div>
            <div onclick="tab('stok')" id="n-stok" class="nav-link"><i class="fa-solid fa-box"></i> <span>Stok Takibi</span></div>
            <div onclick="tab('pers')" id="n-pers" class="nav-link"><i class="fa-solid fa-users-gear"></i> <span>Personel</span></div>
            <div onclick="tab('kasa')" id="n-kasa" class="nav-link"><i class="fa-solid fa-wallet"></i> <span>Muhasebe</span></div>
            <div onclick="tab('analiz')" id="n-analiz" class="nav-link"><i class="fa-solid fa-chart-line"></i> <span>Raporlar</span></div>
        </div>
    </div>

    <div class="main-content">
        
        <div id="v-dash" class="view space-y-8">
            <div class="flex justify-between items-end">
                <div><h2 class="text-3xl font-black">Genel Durum</h2><p id="live-clock" class="text-blue-600 font-bold"></p></div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div class="glass-card"><p class="text-[10px] font-bold text-slate-400 uppercase">Ciro</p><h3 id="d-ciro" class="text-2xl font-black">‚Ç∫0</h3></div>
                <div class="glass-card"><p class="text-[10px] font-bold text-slate-400 uppercase">M√º≈üteri</p><h3 id="d-must" class="text-2xl font-black">0</h3></div>
                <div class="glass-card"><p class="text-[10px] font-bold text-slate-400 uppercase">Bekleyen</p><h3 id="d-rand" class="text-2xl font-black">0</h3></div>
                <div class="glass-card"><p class="text-[10px] font-bold text-slate-400 uppercase">Net Kasa</p><h3 id="d-net" class="text-2xl font-black text-green-500">‚Ç∫0</h3></div>
            </div>
            <div class="glass-card">
                <h4 class="font-bold mb-4">Hƒ±zlƒ± Notlar</h4>
                <textarea id="shop-note" onchange="saveShopNote()" class="w-full h-32 bg-slate-50 border-none p-4 rounded-xl italic" placeholder="Notlarƒ±nƒ±zƒ± buraya yazƒ±n..."></textarea>
            </div>
        </div>

        <div id="v-rand" class="view hidden">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-black">Haftalƒ±k Plan</h2>
                <button onclick="openModal('r-modal')" class="btn-action w-auto px-10">+ Yeni Randevu</button>
            </div>
            
            <div class="calendar-container">
                <div class="calendar-grid">
                    <div class="day-column" id="day-1"><div class="day-header"><h5>Pazartesi</h5></div><div class="items"></div></div>
                    <div class="day-column" id="day-2"><div class="day-header"><h5>Salƒ±</h5></div><div class="items"></div></div>
                    <div class="day-column" id="day-3"><div class="day-header"><h5>√áar≈üamba</h5></div><div class="items"></div></div>
                    <div class="day-column" id="day-4"><div class="day-header"><h5>Per≈üembe</h5></div><div class="items"></div></div>
                    <div class="day-column" id="day-5"><div class="day-header"><h5>Cuma</h5></div><div class="items"></div></div>
                    <div class="day-column" id="day-6"><div class="day-header"><h5>Cumartesi</h5></div><div class="items"></div></div>
                    <div class="day-column" id="day-0"><div class="day-header"><h5>Pazar</h5></div><div class="items"></div></div>
                </div>
            </div>
        </div>

        <div id="v-must" class="view hidden">
            <div class="flex justify-between items-center mb-8"><h2 class="text-3xl font-black">M√º≈üteri Portf√∂y√º</h2><button onclick="openModal('m-modal')" class="btn-action w-auto px-8">+ M√º≈üteri Ekle</button></div>
            <div class="glass-card overflow-x-auto">
                <table class="w-full text-left">
                    <thead><tr class="text-[11px] text-slate-400 uppercase font-black"><th class="p-4">ƒ∞sim</th><th>ƒ∞≈ülem</th><th>Notlar</th><th>√úcret</th><th>Aksiyon</th></tr></thead>
                    <tbody id="m-table" class="font-bold text-sm"></tbody>
                </table>
            </div>
        </div>

        <div id="v-stok" class="view hidden">
            <div class="flex justify-between items-center mb-8"><h2 class="text-3xl font-black">√úr√ºn & Stok</h2><button onclick="openModal('s-modal')" class="btn-action w-auto px-8">+ Stok Ekle</button></div>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6" id="s-grid"></div>
        </div>

        <div id="v-pers" class="view hidden">
            <h2 class="text-3xl font-black mb-8">Personel Y√∂netimi</h2>
            <div id="p-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6"></div>
        </div>

        <div id="v-kasa" class="view hidden">
            <h2 class="text-3xl font-black mb-8">Kasa Hareketleri</h2>
            <div class="grid grid-cols-2 gap-6 mb-8">
                <div class="glass-card border-l-4 border-green-500"><input id="f-g-ad" placeholder="Gelir Adƒ±"><input id="f-g-tutar" type="number" placeholder="Tutar"><button onclick="saveF('gelir')" class="btn-action bg-green-500">GELƒ∞R EKLE</button></div>
                <div class="glass-card border-l-4 border-red-500"><input id="f-gi-ad" placeholder="Gider Adƒ±"><input id="f-gi-tutar" type="number" placeholder="Tutar"><button onclick="saveF('gider')" class="btn-action bg-red-500">Gƒ∞DER EKLE</button></div>
            </div>
            <div id="f-list" class="space-y-3"></div>
        </div>

        <div id="v-analiz" class="view hidden">
            <h2 class="text-3xl font-black mb-8">Finansal Analiz</h2>
            <div class="glass-card bg-slate-900 text-white p-12 text-center">
                <p class="opacity-50 text-xs font-bold uppercase mb-2">Toplam Ciro</p>
                <h3 id="a-brut" class="text-5xl font-black">‚Ç∫0</h3>
                <div class="grid grid-cols-2 mt-10 border-t border-white/10 pt-10">
                    <div><p class="opacity-40 text-xs uppercase">Net K√¢r</p><h5 id="a-kar" class="text-2xl font-bold">‚Ç∫0</h5></div>
                    <div><p class="opacity-40 text-xs uppercase">Gider Toplamƒ±</p><h5 id="a-gider" class="text-2xl font-bold">‚Ç∫0</h5></div>
                </div>
            </div>
        </div>

    </div>

    <div id="m-modal" class="modal"><div class="modal-content"><h3 class="font-black text-xl mb-6">M√ú≈ûTERƒ∞ KAYDI</h3><input id="mi-ad" placeholder="Ad Soyad"><input id="mi-islem" placeholder="ƒ∞≈ülem"><input id="mi-boya" placeholder="Boya No"><input id="mi-ucret" type="number" placeholder="√úcret ‚Ç∫"><button onclick="saveM()" class="btn-action">KAYDET</button></div></div>
    
    <div id="r-modal" class="modal"><div class="modal-content"><h3 class="font-black text-xl mb-6">RANDEVU KAYDI</h3><input id="ri-ad" placeholder="M√º≈üteri ƒ∞smi"><input id="ri-tarih" type="date"><input id="ri-saat" type="time"><button onclick="saveR()" class="btn-action">RANDEVUYU M√úH√úRLE</button></div></div>

    <div id="s-modal" class="modal"><div class="modal-content"><h3 class="font-black text-xl mb-6">STOK Gƒ∞Rƒ∞≈ûƒ∞</h3><input id="si-ad" placeholder="√úr√ºn Adƒ±"><input id="si-adet" type="number" placeholder="Adet"><button onclick="saveS()" class="btn-action">STOƒûA EKLE</button></div></div>

    <script>
        const firebaseConfig = { databaseURL: "https://yusufakdenizhairpalace-c6884-default-rtdb.europe-west1.firebasedatabase.app/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function tab(t) {
            document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
            document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('nav-active'));
            document.getElementById('v-'+t).classList.remove('hidden');
            document.getElementById('n-'+t).classList.add('nav-active');
        }

        function openModal(id) { document.getElementById(id).style.display = 'flex'; }
        window.onclick = (e) => { if(e.target.className === 'modal') e.target.style.display='none'; }

        // VERƒ∞ AKI≈ûI
        db.ref('/').on('value', (snap) => {
            const data = snap.val() || {m:{}, r:{}, s:{}, p:{}, f:{}, n:""};
            renderD(data); renderM(data.m); renderR(data.r); renderS(data.s); renderP(data.p); renderF(data.f);
            document.getElementById('shop-note').value = data.n || "";
        });

        function renderD(data) {
            let ciro = 0, gider = 0, mCount = Object.keys(data.m || {}).length, rCount = Object.keys(data.r || {}).length;
            if(data.m) Object.values(data.m).forEach(x => ciro += parseInt(x.ucret || 0));
            if(data.f) Object.values(data.f).forEach(x => { if(x.tip==='gider') gider += parseInt(x.tutar || 0); else ciro += parseInt(x.tutar || 0); });
            document.getElementById('d-ciro').innerText = "‚Ç∫"+ciro;
            document.getElementById('d-must').innerText = mCount;
            document.getElementById('d-rand').innerText = rCount;
            document.getElementById('d-net').innerText = "‚Ç∫"+(ciro-gider);
            document.getElementById('a-brut').innerText = "‚Ç∫"+ciro;
            document.getElementById('a-gider').innerText = "‚Ç∫"+gider;
            document.getElementById('a-kar').innerText = "‚Ç∫"+(ciro-gider);
        }

        function renderM(m) {
            const t = document.getElementById('m-table'); t.innerHTML = "";
            if(m) Object.keys(m).reverse().forEach(id => {
                const x = m[id];
                t.innerHTML += `<tr class="border-b border-slate-50"><td class="p-4">${x.ad}</td><td>${x.islem}</td><td><span class="bg-blue-50 text-blue-600 px-2 py-1 rounded text-[10px]">${x.boya||'-'}</span></td><td class="text-blue-600">‚Ç∫${x.ucret}</td><td><button onclick="del('m','${id}')"><i class="fa-solid fa-trash opacity-20 hover:opacity-100 text-red-500"></i></button></td></tr>`;
            });
        }

        function renderR(r) {
            // S√ºtunlarƒ± temizle
            document.querySelectorAll('.day-column .items').forEach(div => div.innerHTML = "");
            if(!r) return;
            Object.keys(r).forEach(id => {
                const x = r[id];
                const d = new Date(x.tarih).getDay(); // 0: Pazar, 1: Pazartesi...
                const target = document.querySelector(`#day-${d} .items`);
