<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>yusufhairpalace - Giriş</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
        :root { --sidebar-w: 280px; --primary: #4318ff; --dark: #0b1437; --light-bg: #f4f7fe; }
        * { margin:0; padding:0; box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; }
        body { background: var(--light-bg); color: #1b2559; overflow-x: hidden; }

        /* GİRİŞ EKRANI (Attığın Görseldeki Stil) */
        #login-screen { position: fixed; inset: 0; background: #fff; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        #login-screen h2 { font-size: 24px; font-weight: 800; margin-bottom: 20px; }
        #login-screen input { padding: 12px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 10px; width: 250px; text-align: center; }
        #login-screen button { padding: 12px 40px; background: var(--primary); color: #fff; border-radius: 8px; font-weight: bold; cursor: pointer; }

        /* ANA PANEL TASARIMI */
        .sidebar { width: var(--sidebar-w); height: 100vh; background: #fff; position: fixed; left: 0; top: 0; z-index: 1000; border-right: 1px solid #e9edf7; }
        .main-content { margin-left: var(--sidebar-w); padding: 30px; }
        .nav-link { margin: 4px 20px; padding: 15px 20px; display: flex; align-items: center; gap: 12px; color: #a3aed0; font-weight: 700; border-radius: 12px; cursor: pointer; }
        .nav-active { background: var(--light-bg); color: var(--primary); }
        .glass-card { background: #fff; border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(112, 144, 176, 0.05); }
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 5000; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .hidden { display: none !important; }

        /* HAFTALIK SÜTUNLAR */
        .week-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; min-width: 1200px; }
        .day-column { background: #fff; border-radius: 15px; min-height: 500px; border: 1px solid #e9edf7; }
        .day-header { padding: 10px; text-align: center; font-weight: 800; color: var(--primary); border-bottom: 2px solid var(--light-bg); font-size: 11px; }
        .app-item { background: #fff1e6; border-left: 4px solid #ff9100; padding: 8px; margin: 6px; border-radius: 6px; font-size: 10px; font-weight: 700; }

        @media (max-width: 1024px) {
            .sidebar { width: 80px; } .sidebar span, .sidebar h1 { display: none; }
            .main-content { margin-left: 80px; padding: 15px; }
        }
    </style>
</head>
<body>

    <div id="login-screen">
        <h2>yusufhairpalace</h2>
        <input type="password" id="pass" placeholder="Şifre">
        <button onclick="login()">Giriş</button>
    </div>

    <div id="app-wrapper" class="hidden">
        <div class="sidebar">
            <div class="p-10 text-center border-b mb-4"><h1 class="text-xl font-black italic text-blue-600">PANEL</h1></div>
            <div onclick="tab('dash')" id="n-dash" class="nav-link nav-active"><i class="fa-solid fa-house"></i> <span>Dashboard</span></div>
            <div onclick="tab('must')" id="n-must" class="nav-link"><i class="fa-solid fa-users"></i> <span>Müşteriler</span></div>
            <div onclick="tab('rand')" id="n-rand" class="nav-link"><i class="fa-solid fa-calendar-week"></i> <span>Randevular</span></div>
            <div onclick="tab('stok')" id="n-stok" class="nav-link"><i class="fa-solid fa-box"></i> <span>Stok Takibi</span></div>
            <div onclick="tab('pers')" id="n-pers" class="nav-link"><i class="fa-solid fa-user-tie"></i> <span>Personel/Masa</span></div>
            <div onclick="tab('kasa')" id="n-kasa" class="nav-link"><i class="fa-solid fa-vault"></i> <span>Kasa</span></div>
        </div>

        <div class="main-content">
            <div id="v-dash" class="view space-y-6">
                <div class="flex justify-between items-center"><h2 class="text-3xl font-black">Genel Durum</h2><div id="clock" class="text-xl font-black"></div></div>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="glass-card"><p class="text-xs font-bold text-slate-400 text-uppercase">CİRO</p><h3 id="d-ciro" class="text-2xl font-black text-blue-600">₺0</h3></div>
                    <div class="glass-card"><p class="text-xs font-bold text-slate-400 text-uppercase">NET</p><h3 id="d-net" class="text-2xl font-black text-green-500">₺0</h3></div>
                    <div class="glass-card"><p class="text-xs font-bold text-slate-400 text-uppercase">MÜŞTERİ</p><h3 id="d-must" class="text-2xl font-black">0</h3></div>
                    <div class="glass-card"><p class="text-xs font-bold text-slate-400 text-uppercase">RANDEVU</p><h3 id="d-rand" class="text-2xl font-black text-orange-500">0</h3></div>
                </div>
                <div class="glass-card">
                    <h4 class="font-black mb-4">Son Müşteri Kayıtları</h4>
                    <div id="recent-list" class="space-y-2"></div>
                </div>
            </div>

            <div id="v-must" class="view hidden">
                <div class="flex justify-between mb-8"><h2 class="text-3xl font-black">Müşteriler</h2><button onclick="openModal('m-modal')" class="bg-blue-600 text-white px-6 py-3 rounded-xl font-bold">+ Yeni Kayıt</button></div>
                <div class="bg-white rounded-3xl overflow-hidden shadow-sm">
                    <table class="w-full text-left">
                        <thead class="bg-slate-50 text-slate-400 text-[11px] font-bold"><tr><th class="p-5">İSİM</th><th class="p-5">İŞLEM</th><th class="p-5">NOT</th><th class="p-5">ÜCRET</th><th class="p-5">SİL</th></tr></thead>
                        <tbody id="m-table" class="font-bold text-sm"></tbody>
                    </table>
                </div>
            </div>

            <div id="v-rand" class="view hidden">
                <div class="flex justify-between mb-8"><h2 class="text-3xl font-black">Randevu Planı</h2><button onclick="openModal('r-modal')" class="bg-orange-500 text-white px-6 py-3 rounded-xl font-bold">+ Randevu Ekle</button></div>
                <div class="overflow-x-auto pb-10">
                    <div class="week-grid">
                        <div class="day-column"><div class="day-header">Pazartesi</div><div id="day-1" class="p-1"></div></div>
                        <div class="day-column"><div class="day-header">Salı</div><div id="day-2" class="p-1"></div></div>
                        <div class="day-column"><div class="day-header">Çarşamba</div><div id="day-3" class="p-1"></div></div>
                        <div class="day-column"><div class="day-header">Perşembe</div><div id="day-4" class="p-1"></div></div>
                        <div class="day-column"><div class="day-header">Cuma</div><div id="day-5" class="p-1"></div></div>
                        <div class="day-column"><div class="day-header">Cumartesi</div><div id="day-6" class="p-1"></div></div>
                        <div class="day-column"><div class="day-header">Pazar</div><div id="day-0" class="p-1"></div></div>
                    </div>
                </div>
            </div>

            <div id="v-stok" class="view hidden">
                <div class="flex justify-between mb-8"><h2 class="text-3xl font-black">Stok</h2><button onclick="openModal('s-modal')" class="bg-slate-800 text-white px-6 py-3 rounded-xl font-bold">Ürün Ekle</button></div>
                <div id="s-grid" class="grid grid-cols-1 md:grid-cols-4 gap-6"></div>
            </div>

            <div id="v-pers" class="view hidden">
                <h2 class="text-3xl font-black mb-8">Personel Masaları</h2>
                <div id="p-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6"></div>
            </div>

            <div id="v-kasa" class="view hidden">
                <h2 class="text-3xl font-black mb-8">Muhasebe</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div class="glass-card border-l-8 border-green-500"><h4 class="font-black mb-4 uppercase">Gelir</h4><input id="f-g-ad" placeholder="Kaynak" class="w-full p-3 bg-slate-50 rounded-lg mb-2 outline-none"><input id="f-g-tutar" type="number" placeholder="Tutar" class="w-full p-3 bg-slate-50 rounded-lg mb-4 outline-none"><button onclick="saveF('gelir')" class="w-full bg-green-500 text-white p-3 rounded-lg font-bold">EKLE</button></div>
                    <div class="glass-card border-l-8 border-red-500"><h4 class="font-black mb-4 uppercase">Gider</h4><input id="f-gi-ad" placeholder="Kalem" class="w-full p-3 bg-slate-50 rounded-lg mb-2 outline-none"><input id="f-gi-tutar" type="number" placeholder="Tutar" class="w-full p-3 bg-slate-50 rounded-lg mb-4 outline-none"><button onclick="saveF('gider')" class="w-full bg-red-500 text-white p-3 rounded-lg font-bold">ÇIKAR</button></div>
                </div>
                <div id="f-list" class="space-y-2 font-bold"></div>
            </div>
        </div>
    </div>

    <div id="m-modal" class="modal"><div class="bg-white p-8 rounded-3xl w-full max-w-sm"><h3 class="font-black text-xl mb-4 italic">MÜŞTERİ KAYDI</h3><input id="mi-ad" placeholder="Müşteri Ad Soyad" class="w-full p-3 bg-slate-100 rounded-xl mb-3 outline-none"><input id="mi-uc" type="number" placeholder="Ücret ₺" class="w-full p-3 bg-slate-100 rounded-xl mb-3 outline-none"><input id="mi-is" placeholder="Yapılan İşlem" class="w-full p-3 bg-slate-100 rounded-xl mb-3 outline-none"><textarea id="mi-bo" placeholder="Boya Kodları / Notlar" class="w-full p-3 bg-slate-100 rounded-xl mb-4 h-24 outline-none"></textarea><button onclick="saveM()" class="w-full bg-blue-600 text-white p-4 rounded-xl font-bold">KAYDET</button><button onclick="closeModal('m-modal')" class="w-full mt-2 text-slate-400 font-bold">İptal</button></div></div>

    <div id="r-modal" class="modal"><div class="bg-white p-8 rounded-3xl w-full max-w-sm"><h3 class="font-black text-xl mb-4">Randevu Ekle</h3><input id="ri-ad" placeholder="Müşteri Adı" class="w-full p-3 bg-slate-100 rounded-xl mb-2 outline-none"><input id="ri-ph" placeholder="Telefon" class="w-full p-3 bg-slate-100 rounded-xl mb-2 outline-none"><input id="ri-t" type="date" class="w-full p-3 bg-slate-100 rounded-xl mb-2 outline-none"><input id="ri-s" type="time" class="w-full p-3 bg-slate-100 rounded-xl mb-2 outline-none"><select id="ri-ps" class="w-full p-3 bg-slate-100 rounded-xl mb-2 outline-none"></select><input id="ri-is" placeholder="İşlem" class="w-full p-3 bg-slate-100 rounded-xl mb-4 outline-none"><button onclick="saveR()" class="w-full bg-orange-500 text-white p-4 rounded-xl font-bold">RANDEVU KAYDET</button></div></div>

    <div id="s-modal" class="modal"><div class="bg-white p-8 rounded-3xl w-80"><h3 class="font-black text-xl mb-4">Ürün Ekle</h3><input id="si-ad" placeholder="Ürün" class="w-full p-3 bg-slate-100 rounded-xl mb-3 outline-none"><input id="si-at" type="number" placeholder="Adet" class="w-full p-3 bg-slate-100 rounded-xl mb-4 outline-none"><button onclick="saveS()" class="w-full bg-slate-800 text-white p-4 rounded-xl font-bold">KAYDET</button></div></div>

    <script>
        // Veritabanı Bağlantısı (Sabitlendi)
        const firebaseConfig = { databaseURL: "https://yusufakdenizhairpalace-c6884-default-rtdb.europe-west1.firebasedatabase.app/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // GİRİŞ FONKSİYONU (Görsel 1 Düzeltildi)
        function login(){
            if(document.getElementById("pass").value === "1234") {
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('app-wrapper').classList.remove('hidden');
            } else {
                alert("Şifre Yanlış");
            }
        }

        function tab(t) {
            document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
            document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('nav-active'));
            document.getElementById('v-'+t).classList.remove('hidden');
            document.getElementById('n-'+t).classList.add('nav-active');
        }

        function openModal(id) { document.getElementById(id).style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        // Veri Çekme ve Render
        db.ref('/').on('value', (snap) => {
            const data = snap.val() || {};
            renderAll(data);
        });

        function renderAll(data) {
            // Müşteriler & Dashboard
            const mTable = document.getElementById('m-table'); mTable.innerHTML = "";
            const recList = document.getElementById('recent-list'); recList.innerHTML = "";
            let ciro = 0, gider = 0;

            if(data.m) {
                Object.keys(data.m).reverse().forEach(id => {
                    const x = data.m[id]; ciro += parseInt(x.uc || 0);
                    mTable.innerHTML += `<tr class="border-b"> <td class="p-5">${x.ad}</td> <td class="p-5 text-blue-500">${x.is}</td> <td class="p-5 text-xs text-slate-400">${x.bo || '-'}</td> <td class="p-5">₺${x.uc}</td> <td class="p-5"><button onclick="del('m','${id}')" class="text-red-400">Sil</button></td> </tr>`;
                });
                Object.values(data.m).slice(-3).forEach(x => {
                    recList.innerHTML += `<div class="flex justify-between p-3 bg-slate-50 rounded-xl font-bold"><span>${x.ad}</span><span>₺${x.uc}</span></div>`;
                });
            }

            // Randevular (Haftalık Tablo)
            for(let i=0; i<=6; i++) document.getElementById('day-'+i).innerHTML = "";
            if(data.r) {
                Object.keys(data.r).forEach(id => {
                    const x = data.r[id]; const day = new Date(x.t).getDay();
                    document.getElementById('day-'+day).innerHTML += `<div class="app-item"><b>${x.s}</b> | ${x.ad}<br><small>${x.ps || 'Personel'}</small><button onclick="del('r','${id}')" class="float-right text-orange-400">x</button></div>`;
                });
            }

            // Personel Listesi (Modal Seçeneği)
            const rSelect = document.getElementById('ri-ps'); rSelect.innerHTML = "<option value=''>Personel Seç</option>";
            const pGrid = document.getElementById('p-grid'); pGrid.innerHTML = "";
            for(let i=1; i<=10; i++) {
                const x = (data.p && data.p[i]) ? data.p[i] : {name:'Masa '+i, av:0};
                rSelect.innerHTML += `<option value="${x.name}">${x.name}</option>`;
                pGrid.innerHTML += `<div class="glass-card"><div class="flex justify-between mb-4"><input onchange="updP(${i},this.value)" value="${x.name}" class="font-bold border-none bg-transparent w-32"> <span class="text-[9px] bg-blue-600 text-white px-2 py-1 rounded">MASA ${i}</span></div><div class="bg-red-50 p-4 rounded-xl text-center"><p class="text-[10px] text-red-300">AVANS/BORÇ</p><h4 class="text-xl font-black text-red-500">₺${x.av || 0}</h4></div><div class="flex gap-2 mt-4"><input id="av-${i}" type="number" placeholder="₺" class="w-full bg-slate-50 p-2 rounded-lg text-sm outline-none"><button onclick="addA(${i})" class="bg-blue-600 text-white px-4 rounded-lg">+</button></div></div>`;
            }

            // Stok
            const sGrid = document.getElementById('s-grid'); sGrid.innerHTML = "";
            if(data.s) {
                Object.keys(data.s).forEach(id => {
                    const x = data.s[id];
                    sGrid.innerHTML += `<div class="glass-card text-center"><p class="text-xs font-bold text-slate-400">${x.ad}</p><h4 class="text-2xl font-black my-2">${x.at}</h4><div class="flex gap-2 justify-center"><button onclick="updS('${id}',-1)" class="bg-slate-100 w-8 h-8 rounded-lg">-</button><button onclick="updS('${id}',1)" class="bg-slate-100 w-8 h-8 rounded-lg">+</button></div></div>`;
                });
            }

            // Kasa
            const fList = document.getElementById('f-list'); fList.innerHTML = "";
            if(data.f) {
                Object.keys(data.f).reverse().forEach(id => {
                    const x = data.f[id]; if(x.tip==='gider') gider += parseInt(x.tutar); else ciro += parseInt(x.tutar);
                    const col = x.tip==='gider' ? 'text-red-600 bg-red-50' : 'text-green-600 bg-green-50';
                    fList.innerHTML += `<div class="p-3 ${col} rounded-xl flex justify-between"><span>${x.ad}</span><span>₺${x.tutar}</span></div>`;
                });
            }

            document.getElementById('d-ciro').innerText = "₺"+ciro;
            document.getElementById('d-net').innerText = "₺"+(ciro-gider);
            document.getElementById('d-must').innerText = Object.keys(data.m || {}).length;
            document.getElementById('d-rand').innerText = Object.keys(data.r || {}).length;
        }

        // Kayıt Fonksiyonları
        function saveM() { const ad=document.getElementById('mi-ad').value, uc=document.getElementById('mi-uc').value, is=document.getElementById('mi-is').value, bo=document.getElementById('mi-bo').value; if(ad&&uc) db.ref('m').push({ad,uc,is,bo}); closeModal('m-modal'); }
        function saveR() { const ad=document.getElementById('ri-ad').value, ph=document.getElementById('ri-ph').value, t=document.getElementById('ri-t').value, s=document.getElementById('ri-s').value, ps=document.getElementById('ri-ps').value, is=document.getElementById('ri-is').value; if(ad&&t&&s) db.ref('r').push({ad,ph,t,s,ps,is}); closeModal('r-modal'); }
        function saveS() { const ad=document.getElementById('si-ad').value, at=document.getElementById('si-at').value; if(ad&&at) db.ref('s').push({ad,at}); closeModal('s-modal'); }
        function saveF(tip) { 
            const ad = tip==='gelir' ? document.getElementById('f-g-ad').value : document.getElementById('f-gi-ad').value;
            const tutar = tip==='gelir' ? document.getElementById('f-g-tutar').value : document.getElementById('f-gi-tutar').value;
            if(ad&&tutar) db.ref('f').push({tip,ad,tutar});
        }
        function updP(id, n) { db.ref('p/'+id+'/name').set(n); }
        function addA(id) { const v=document.getElementById('av-'+id).value; if(v) db.ref('p/'+id+'/av').transaction(c=>(c||0)+parseInt(v)); document.getElementById('av-'+id).value=""; }
        function updS(id, n) { db.ref('s/'+id+'/at').transaction(c=>(c||0)+n); }
        function del(p, id) { if(confirm('Silinsin mi?')) db.ref(p+'/'+id).remove(); }
        setInterval(() => { document.getElementById('clock').innerText = new Date().toLocaleTimeString('tr-TR'); }, 1000);
    </script>
</body>
</html>
